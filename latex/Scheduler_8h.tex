\hypertarget{Scheduler_8h}{}\doxysection{Inc/\+Scheduler/\+Scheduler.h File Reference}
\label{Scheduler_8h}\index{Inc/Scheduler/Scheduler.h@{Inc/Scheduler/Scheduler.h}}
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Sensors/\+Sensor.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Priority\+Queue.\+h\char`\"{}}\newline
Include dependency graph for Scheduler.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structScheduler}{Scheduler}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{Scheduler_8h_aa3d1fc2927eec213e6b5f9e854c392d2}{MAX\+\_\+\+SENSORS}}~10
\item 
\#define \mbox{\hyperlink{Scheduler_8h_a7d29c4b367c3554d638e5b0d977e8b41}{MAX\+\_\+\+HZ}}~1000
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \mbox{\hyperlink{structScheduler}{Scheduler}} \mbox{\hyperlink{Scheduler_8h_a1ef1f6f320939ca611a0caca79a97ff1}{Scheduler}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{Scheduler_8h_adf18e0985dd8f66c0a65156d46718c5a}{Scheduler\+Init}} (\mbox{\hyperlink{structScheduler}{Scheduler}} $\ast$scheduler, \mbox{\hyperlink{structSensor}{Sensor}} $\ast$sensor\+Array\mbox{[}$\,$\mbox{]}, int num\+Sensors)
\begin{DoxyCompactList}\small\item\em Initializes the scheduler with the given sensors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{Scheduler_8h_ab8065221debac476c547533f73504c20}{Scheduler\+Run}} (\mbox{\hyperlink{structScheduler}{Scheduler}} $\ast$scheduler)
\begin{DoxyCompactList}\small\item\em Runs the scheduler, executing tasks based on their priority. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{Scheduler_8h_ab6d888e50b0c00ef172f5e4dc325220e}{Scheduler\+Stop}} (\mbox{\hyperlink{structScheduler}{Scheduler}} $\ast$scheduler)
\begin{DoxyCompactList}\small\item\em Stops the scheduler. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{Scheduler_8h_a7d29c4b367c3554d638e5b0d977e8b41}\label{Scheduler_8h_a7d29c4b367c3554d638e5b0d977e8b41}} 
\index{Scheduler.h@{Scheduler.h}!MAX\_HZ@{MAX\_HZ}}
\index{MAX\_HZ@{MAX\_HZ}!Scheduler.h@{Scheduler.h}}
\doxysubsubsection{\texorpdfstring{MAX\_HZ}{MAX\_HZ}}
{\footnotesize\ttfamily \#define MAX\+\_\+\+HZ~1000}



Definition at line \mbox{\hyperlink{Scheduler_8h_source_l00011}{11}} of file \mbox{\hyperlink{Scheduler_8h_source}{Scheduler.\+h}}.

\mbox{\Hypertarget{Scheduler_8h_aa3d1fc2927eec213e6b5f9e854c392d2}\label{Scheduler_8h_aa3d1fc2927eec213e6b5f9e854c392d2}} 
\index{Scheduler.h@{Scheduler.h}!MAX\_SENSORS@{MAX\_SENSORS}}
\index{MAX\_SENSORS@{MAX\_SENSORS}!Scheduler.h@{Scheduler.h}}
\doxysubsubsection{\texorpdfstring{MAX\_SENSORS}{MAX\_SENSORS}}
{\footnotesize\ttfamily \#define MAX\+\_\+\+SENSORS~10}



Definition at line \mbox{\hyperlink{Scheduler_8h_source_l00010}{10}} of file \mbox{\hyperlink{Scheduler_8h_source}{Scheduler.\+h}}.



\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{Scheduler_8h_a1ef1f6f320939ca611a0caca79a97ff1}\label{Scheduler_8h_a1ef1f6f320939ca611a0caca79a97ff1}} 
\index{Scheduler.h@{Scheduler.h}!Scheduler@{Scheduler}}
\index{Scheduler@{Scheduler}!Scheduler.h@{Scheduler.h}}
\doxysubsubsection{\texorpdfstring{Scheduler}{Scheduler}}
{\footnotesize\ttfamily typedef struct \mbox{\hyperlink{structScheduler}{Scheduler}} \mbox{\hyperlink{structScheduler}{Scheduler}}}



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{Scheduler_8h_adf18e0985dd8f66c0a65156d46718c5a}\label{Scheduler_8h_adf18e0985dd8f66c0a65156d46718c5a}} 
\index{Scheduler.h@{Scheduler.h}!SchedulerInit@{SchedulerInit}}
\index{SchedulerInit@{SchedulerInit}!Scheduler.h@{Scheduler.h}}
\doxysubsubsection{\texorpdfstring{SchedulerInit()}{SchedulerInit()}}
{\footnotesize\ttfamily void Scheduler\+Init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structScheduler}{Scheduler}} $\ast$}]{scheduler,  }\item[{\mbox{\hyperlink{structSensor}{Sensor}} $\ast$}]{sensor\+Array\mbox{[}$\,$\mbox{]},  }\item[{int}]{num\+Sensors }\end{DoxyParamCaption})}



Initializes the scheduler with the given sensors. 


\begin{DoxyParams}{Parameters}
{\em scheduler} & Pointer to the \mbox{\hyperlink{structScheduler}{Scheduler}} structure to initialize. \\
\hline
{\em sensor\+Array} & Array of pointers to \mbox{\hyperlink{structSensor}{Sensor}} structures to be scheduled. \\
\hline
{\em num\+Sensors} & Number of sensors in the sensor\+Array.\\
\hline
\end{DoxyParams}
Initializes the priority queue and schedules tasks based on the given sensors and their update frequencies. Limits the number of sensors to MAX\+\_\+\+SENSORS. 

Definition at line \mbox{\hyperlink{Scheduler_8c_source_l00013}{13}} of file \mbox{\hyperlink{Scheduler_8c_source}{Scheduler.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00013                                                                                 \{}
\DoxyCodeLine{00014     \textcolor{keywordflow}{if} (numSensors > \mbox{\hyperlink{PriorityQueue_8h_aa3d1fc2927eec213e6b5f9e854c392d2}{MAX\_SENSORS}}) \{}
\DoxyCodeLine{00015         printf(\textcolor{stringliteral}{"{}Warning: Number of sensors exceeds MAX\_SENSORS. Some sensors will not be scheduled.\(\backslash\)n"{}});}
\DoxyCodeLine{00016         numSensors = \mbox{\hyperlink{PriorityQueue_8h_aa3d1fc2927eec213e6b5f9e854c392d2}{MAX\_SENSORS}};  \textcolor{comment}{// Limit the number of sensors to MAX\_SENSORS}}
\DoxyCodeLine{00017     \}}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019     \mbox{\hyperlink{PriorityQueue_8h_af5ad572e37189c56cf0816638dd85d97}{PQInit}}(\&scheduler-\/>\mbox{\hyperlink{structScheduler_a1327381025bb2063f14564ba5cb748c6}{tasks}});}
\DoxyCodeLine{00020     scheduler-\/>\mbox{\hyperlink{structScheduler_a8a0b0619fdfbda3338fc4964999b3ffd}{running}} = \textcolor{keyword}{false};}
\DoxyCodeLine{00021 }
\DoxyCodeLine{00022     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < numSensors; i++) \{}
\DoxyCodeLine{00023         \mbox{\hyperlink{structTask}{Task}} task;}
\DoxyCodeLine{00024         \mbox{\hyperlink{structSensor}{Sensor}}* sensor = sensorArray[i];}
\DoxyCodeLine{00025         \textcolor{keywordflow}{if} (sensor == NULL) \{}
\DoxyCodeLine{00026             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00027         \}}
\DoxyCodeLine{00028         \mbox{\hyperlink{Task_8h_ada95c849b23900ccbebc6a389f6dba19}{TaskInit}}(\&task, sensor, sensor-\/>\mbox{\hyperlink{structSensor_a7e6cf7138f6d350fd2bf0a76fba7a2ad}{updateable}}.\mbox{\hyperlink{structUpdateable_a4a1e49fba540bce56a175e3e1083f1a5}{hz}});}
\DoxyCodeLine{00029         \textcolor{keywordtype}{int} hz = 1000 / sensor-\/>\mbox{\hyperlink{structSensor_a7e6cf7138f6d350fd2bf0a76fba7a2ad}{updateable}}.\mbox{\hyperlink{structUpdateable_a4a1e49fba540bce56a175e3e1083f1a5}{hz}};}
\DoxyCodeLine{00030         \textcolor{keywordtype}{int} initialPriority = clock() / (CLOCKS\_PER\_SEC / 1000) + hz;}
\DoxyCodeLine{00031         \mbox{\hyperlink{PriorityQueue_8h_ae841bdf0664368f8d4484b0e5dbd33d7}{PQPush}}(\&scheduler-\/>\mbox{\hyperlink{structScheduler_a1327381025bb2063f14564ba5cb748c6}{tasks}}, task, initialPriority);}
\DoxyCodeLine{00032     \}}
\DoxyCodeLine{00033 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 2
\mbox{\Hypertarget{Scheduler_8h_ab8065221debac476c547533f73504c20}\label{Scheduler_8h_ab8065221debac476c547533f73504c20}} 
\index{Scheduler.h@{Scheduler.h}!SchedulerRun@{SchedulerRun}}
\index{SchedulerRun@{SchedulerRun}!Scheduler.h@{Scheduler.h}}
\doxysubsubsection{\texorpdfstring{SchedulerRun()}{SchedulerRun()}}
{\footnotesize\ttfamily void Scheduler\+Run (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structScheduler}{Scheduler}} $\ast$}]{scheduler }\end{DoxyParamCaption})}



Runs the scheduler, executing tasks based on their priority. 


\begin{DoxyParams}{Parameters}
{\em scheduler} & Pointer to the \mbox{\hyperlink{structScheduler}{Scheduler}} structure to run.\\
\hline
\end{DoxyParams}
Runs the scheduler, repeatedly executing tasks based on their scheduled execution times. Uses Sleep or usleep to avoid busy-\/waiting if no tasks are ready to execute. 

Definition at line \mbox{\hyperlink{Scheduler_8c_source_l00040}{40}} of file \mbox{\hyperlink{Scheduler_8c_source}{Scheduler.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00040                                         \{}
\DoxyCodeLine{00041     scheduler-\/>\mbox{\hyperlink{structScheduler_a8a0b0619fdfbda3338fc4964999b3ffd}{running}} = \textcolor{keyword}{true};}
\DoxyCodeLine{00042     \mbox{\hyperlink{structTask}{Task}} currentTask;}
\DoxyCodeLine{00043     \textcolor{keywordtype}{int} sleepTime = 1000 / \mbox{\hyperlink{Scheduler_8h_a7d29c4b367c3554d638e5b0d977e8b41}{MAX\_HZ}}; \textcolor{comment}{// Because Windows}}
\DoxyCodeLine{00044 }
\DoxyCodeLine{00045     \textcolor{keywordflow}{while} (scheduler-\/>\mbox{\hyperlink{structScheduler_a8a0b0619fdfbda3338fc4964999b3ffd}{running}}) \{}
\DoxyCodeLine{00046         \textcolor{keywordtype}{int} currentTime = clock() / (CLOCKS\_PER\_SEC / 1000);}
\DoxyCodeLine{00047         \textcolor{keywordtype}{bool} executed = \textcolor{keyword}{false};}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049         \textcolor{keywordflow}{while} (!\mbox{\hyperlink{PriorityQueue_8h_a3db90f839aff3e0e896ca237483bb926}{PQIsEmpty}}(\&scheduler-\/>\mbox{\hyperlink{structScheduler_a1327381025bb2063f14564ba5cb748c6}{tasks}}) \&\&}
\DoxyCodeLine{00050                 \mbox{\hyperlink{PriorityQueue_8h_a176542d630434d645be4ce5c3e7d5189}{PQPeek}}(\&scheduler-\/>\mbox{\hyperlink{structScheduler_a1327381025bb2063f14564ba5cb748c6}{tasks}}, \&currentTask) \&\&}
\DoxyCodeLine{00051                 currentTask.\mbox{\hyperlink{structTask_aecd0764bd9e73850d02ea0d633fe4ed1}{nextExecTime}} <= currentTime) \{}
\DoxyCodeLine{00052             \textcolor{keywordflow}{if} (\mbox{\hyperlink{PriorityQueue_8h_accf2d5c29ecdd09ea36ac2d7dbb7556f}{PQPop}}(\&scheduler-\/>\mbox{\hyperlink{structScheduler_a1327381025bb2063f14564ba5cb748c6}{tasks}}, \&currentTask)) \{}
\DoxyCodeLine{00053                 \mbox{\hyperlink{Task_8h_af74a92b4c3acbd7beebe1c7e404f6b99}{TaskExecute}}(\&currentTask);}
\DoxyCodeLine{00054                 \textcolor{comment}{// Re-\/schedule task by updating its next execution time}}
\DoxyCodeLine{00055                 currentTask.\mbox{\hyperlink{structTask_aecd0764bd9e73850d02ea0d633fe4ed1}{nextExecTime}} = currentTime + (1000 / currentTask.\mbox{\hyperlink{structTask_a299d1cdf8501da3b0fb21f9e49a245d6}{hz}});}
\DoxyCodeLine{00056                 \textcolor{comment}{// Reinsert task with new priority}}
\DoxyCodeLine{00057                 \mbox{\hyperlink{PriorityQueue_8h_ae841bdf0664368f8d4484b0e5dbd33d7}{PQPush}}(\&scheduler-\/>\mbox{\hyperlink{structScheduler_a1327381025bb2063f14564ba5cb748c6}{tasks}}, currentTask, currentTask.\mbox{\hyperlink{structTask_aecd0764bd9e73850d02ea0d633fe4ed1}{nextExecTime}});}
\DoxyCodeLine{00058                 executed = \textcolor{keyword}{true};}
\DoxyCodeLine{00059             \}}
\DoxyCodeLine{00060         \}}
\DoxyCodeLine{00061 }
\DoxyCodeLine{00062         \textcolor{keywordflow}{if} (!executed) \{}
\DoxyCodeLine{00063             \textcolor{comment}{// Sleep to avoid busy-\/waiting}}
\DoxyCodeLine{00064 \textcolor{preprocessor}{            \#ifdef \_WIN32}}
\DoxyCodeLine{00065             Sleep(sleepTime);}
\DoxyCodeLine{00066 \textcolor{preprocessor}{            \#else}}
\DoxyCodeLine{00067             \textcolor{keyword}{struct }timespec req, rem;}
\DoxyCodeLine{00068             req.tv\_sec = sleepTime / 1000;}
\DoxyCodeLine{00069             req.tv\_nsec = (sleepTime \% 1000) * 1000000L;}
\DoxyCodeLine{00070             nanosleep(\&req, \&rem);}
\DoxyCodeLine{00071 \textcolor{preprocessor}{            \#endif}}
\DoxyCodeLine{00072         \}}
\DoxyCodeLine{00073     \}}
\DoxyCodeLine{00074 \}}

\end{DoxyCode}
Here is the call graph for this function\+:
% FIG 3
\mbox{\Hypertarget{Scheduler_8h_ab6d888e50b0c00ef172f5e4dc325220e}\label{Scheduler_8h_ab6d888e50b0c00ef172f5e4dc325220e}} 
\index{Scheduler.h@{Scheduler.h}!SchedulerStop@{SchedulerStop}}
\index{SchedulerStop@{SchedulerStop}!Scheduler.h@{Scheduler.h}}
\doxysubsubsection{\texorpdfstring{SchedulerStop()}{SchedulerStop()}}
{\footnotesize\ttfamily void Scheduler\+Stop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structScheduler}{Scheduler}} $\ast$}]{scheduler }\end{DoxyParamCaption})}



Stops the scheduler. 


\begin{DoxyParams}{Parameters}
{\em scheduler} & Pointer to the \mbox{\hyperlink{structScheduler}{Scheduler}} structure to stop. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{Scheduler_8c_source_l00076}{76}} of file \mbox{\hyperlink{Scheduler_8c_source}{Scheduler.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00076                                          \{}
\DoxyCodeLine{00077     scheduler-\/>\mbox{\hyperlink{structScheduler_a8a0b0619fdfbda3338fc4964999b3ffd}{running}} = 0;}
\DoxyCodeLine{00078 \}}

\end{DoxyCode}
